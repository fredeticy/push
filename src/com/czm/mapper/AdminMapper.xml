<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.czm.mapper.AdminMapper">
  <sql id="user_list">
    id,userid,roleid,phonenumber,email,address
  </sql>
  
  <sql id ="role_list">
    id,type,date
  </sql>
  
  <sql id ="msg_list">
    id,title,content,date,createrid
  </sql>
  <select id="getAllUsers" resultType="User">
    select
     <include refid="user_list"></include>
     from user;
  
  </select>
  <select id="getAllRoles" resultType="Role">
    select
    <include refid="role_list"></include>
    from role;
  
  </select>
  <select id="getAllMsg" resultType="Message">
    select
    <include refid="msg_list"></include>
    from message;
  </select>
  
  <select id="getUserById" resultType="User">
  	select 
  	*
  	from user where id = #{id};
  </select>

	<select id="getRoleById" resultType="Role">
  	select 
  	<include refid ="role_list"></include>
  	from role where id = #{id};
  </select>
  
  <select id="getMsgById" resultType="Message">
  	select 
  	<include refid ="msg_list"></include>
  	from message where id = #{id};
  </select>
  
  <update id='editUser' parameterType="User">
  	update user
  	set pwd = #{user.pwd},roleid = #{user.roleid},phonenumber = #{user.phonenumber},
  	email = #{user.email}, address = #{user.address}
  	where userid = #{user.userid};
  </update>
	
	<update id='editRole' parameterType="Role">
  	update role
  	set type = #{role.type}, data = #{role.type} 
  	where id = #{role.id};
  </update>
  
  <update id='editMsg' parameterType="Message">
  	update message
  	set  title= #{msg.title},  content= #{msg.content},  date = #{msg.date}
  	where id = #{msg.id};
  </update>
</mapper>